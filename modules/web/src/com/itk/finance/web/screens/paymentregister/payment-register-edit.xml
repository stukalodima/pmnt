<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/screen/window.xsd"
        caption="msg://paymentRegisterEdit.caption"
        focusComponent="form"
        messagesPack="com.itk.finance.web.screens.paymentregister">
    <data>
        <instance id="paymentRegisterDc"
                  class="com.itk.finance.entity.PaymentRegister">
            <view extends="_local">
                <property name="business" view="_minimal"/>
                <property name="paymentRegisters" view="_minimal">
                    <property name="approved"/>
                    <property name="company" view="_minimal"/>
                    <property name="paymentPurpose"/>
                    <property name="cashFlowItem" view="_minimal"/>
                    <property name="paymentType" view="_minimal"/>
                    <property name="comment"/>
                    <property name="paymentRegister" view="_minimal"/>
                    <property name="paymentClaim" view="_minimal"/>
                </property>
                <property name="author" view="_minimal"/>
            </view>
            <loader/>
            <collection id="paymentRegistersDc" property="paymentRegisters"/>
        </instance>
        <collection id="businessesDc" class="com.itk.finance.entity.Business" view="_minimal">
            <loader id="businessesDl">
                <query>
                    <![CDATA[select e from finance_Business e]]>
                </query>
            </loader>
        </collection>
        <collection id="usersDc" class="com.haulmont.cuba.security.entity.User">
            <view extends="_minimal"/>
            <loader id="usersDl">
                <query>
                    <![CDATA[select e from sec$User e]]>
                </query>
            </loader>
        </collection>
    </data>
    <dialogMode height="90%"
                width="75%"
                modal="true"
                forceDialog="true" resizable="true" maximized="true"/>
    <layout expand="paymentRegistersBox" spacing="true" width="100%">
        <form id="form" dataContainer="paymentRegisterDc" width="100%">
            <column width="50%">
                <dateField id="onDateField" property="onDate" width="100%"/>
                <lookupField id="authorField" property="author" width="100%" optionsContainer="usersDc"/>
            </column>
            <column width="50%">
                <lookupPickerField id="businessField" optionsContainer="businessesDc" property="business" width="100%">
                    <actions>
                        <action id="lookup" type="picker_lookup"/>
                        <action id="open" type="picker_open"/>
                        <action id="clear" type="picker_clear"/>
                    </actions>
                </lookupPickerField>
                <lookupField id="statusField" property="status" editable="false" width="100%"/>
            </column>
        </form>
        <groupBox id="paymentRegistersBox" caption="msg://com.itk.finance.entity/PaymentRegister.paymentRegisters"
                  width="100%">
            <dataGrid id="paymentRegistersDetailTable" dataContainer="paymentRegistersDc" editorEnabled="true"
                      width="100%"
                      selectionMode="MULTI_CHECK" height="100%"
                      aggregatable="true"
                      aggregationPosition="BOTTOM"
                      frozenColumnCount="4"
                      responsive="true">
                <actions>
                    <action id="create" type="create"/>
                    <action id="remove" type="remove"/>
                    <action id="refresh" type="refresh"/>
                    <action id="excel" type="excel"/>
                    <action id="fillPaymentClaims" caption="msg://fillPaymentClaims.caption"/>
                    <action id="addLine" caption="msg://addLine.caption"/>
                    <action id="approve" caption="msg://approve.caption"/>
                    <action id="reject" caption="msg://reject.caption"/>
                </actions>
                <buttonsPanel>
                    <button id="paymentRegistersDetailTableApproveBtn" action="paymentRegistersDetailTable.approve"/>
                    <button id="paymentRegistersDetailTableRejectBtn" action="paymentRegistersDetailTable.reject"/>
                    <button id="paymentRegistersDetailTableCreateBtn" action="paymentRegistersDetailTable.create"/>
                    <button id="paymentRegistersDetailTableAddLineBtn" action="paymentRegistersDetailTable.addLine"/>
                    <button id="paymentRegistersDetailTableRemoveBtn" action="paymentRegistersDetailTable.remove"/>
                    <button id="paymentRegistersDetailTableExcelBtn" action="paymentRegistersDetailTable.excel"/>
                    <button id="paymentRegistersDetailTableRefreshBtn" action="paymentRegistersDetailTable.refresh"/>
                    <button id="paymentRegistersDetailTableFillPaymentClaimsBtn"
                            action="paymentRegistersDetailTable.fillPaymentClaims"/>
                </buttonsPanel>
                <columns>
                    <column id="approved" property="approved" width="100" expandRatio="1"/>
                    <column id="company" property="company" minimumWidth="100" width="200" expandRatio="3"/>
                    <column id="client" property="client" minimumWidth="100" width="200" expandRatio="3"/>
                    <column id="summ" property="summ" width="100" expandRatio="2">
                        <aggregation type="SUM" valueDescription="msg://summ.valueDescription">
                        </aggregation>
                        <numberRenderer format="%,.2f"/>
                    </column>
                    <column id="paymentPurpose" property="paymentPurpose" width="200" minimumWidth="100"
                            expandRatio="3"/>
                    <column id="cashFlowItem" property="cashFlowItem" width="200" minimumWidth="100" expandRatio="3"/>
                    <column id="paymentType" property="paymentType" width="200" minimumWidth="100" expandRatio="3"/>
                    <column id="comment" property="comment" width="200" minimumWidth="100" expandRatio="3"/>
                    <column id="paymentClaim" property="paymentClaim" width="200" minimumWidth="100" expandRatio="3"/>
                </columns>
                <rowsCount/>
            </dataGrid>
        </groupBox>
        <hbox id="editActions" spacing="true">
            <button id="commitAndCloseBtn" action="windowCommitAndClose"/>
            <button id="commitBtn" action="windowCommit"/>
            <button id="closeBtn" action="windowClose"/>
        </hbox>
    </layout>
</window>
